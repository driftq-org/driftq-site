---
title: Message Envelope
description: Metadata carried with messages for AI workflows.
---

<div className="space-y-10">

  <section className="space-y-4">
    <p className="m-0">
      In DriftQ-Core, a message can carry an <strong>envelope</strong> — metadata that travels with the message and
      controls how it should be handled.
    </p>

    <div className="rounded-2xl border border-black/10 bg-black/5 px-4 py-3 dark:border-white/10 dark:bg-white/5">
      <p className="m-0">
        <strong>Mental model:</strong> payload = the work, envelope = the rules around that work.
      </p>
    </div>
  </section>

  <section className="space-y-5">
    <h2 className="m-0">Common envelope fields</h2>

    <p className="m-0">An envelope can include fields like:</p>

    <ul className="space-y-2">
      <li><code>tenant_id</code> — multi-tenant separation / accounting</li>
      <li><code>idempotency_key</code> — prevents duplicate side effects across retries</li>
      <li><code>deadline</code> — stop doing this work after a certain point in time</li>
      <li><code>retry_policy</code> — max attempts + backoff parameters</li>
    </ul>

    <div className="rounded-2xl border border-black/10 bg-black/5 p-4 dark:border-white/10 dark:bg-white/5">
      <p className="m-0 font-semibold">Why these matter</p>
      <p className="mt-3 mb-0">
        They let producers define reliability and safety expectations <em>once</em>, and DriftQ-Core enforces them consistently.
      </p>
    </div>
  </section>

  {/* Future */}
  <section className="space-y-5">
    <h2 className="m-0">Why the envelope is a big deal</h2>

    <p className="m-0">
      The envelope is the “control plane” for the message. It’s also how DriftQ evolves beyond a broker:
      it becomes the foundation for routing decisions, safety constraints, and workflow control.
    </p>

    <ul className="space-y-2">
      <li><strong>Routing:</strong> policy-driven routing / partitions / priority</li>
      <li><strong>Retries:</strong> consistent backoff + termination rules</li>
      <li><strong>Budgets:</strong> cost caps, rate limits, tenant quotas</li>
      <li><strong>Tracing:</strong> end-to-end workflow/agent tracing metadata</li>
    </ul>

    <div className="rounded-2xl border border-black/10 bg-black/5 px-4 py-3 dark:border-white/10 dark:bg-white/5">
      <p className="m-0">
        <strong>Roadmap note:</strong> DriftQ-Core is the broker repo you can run today. The envelope is what enables DriftQ
        (the overall project) to grow into a workflow runtime in v2+.
      </p>
    </div>
  </section>

</div>
